---
// src/pages/projects.astro
import { getCollection } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import Main from "@/layouts/Main.astro";
import ProjectCard from "@/components/ProjectCard.astro";

const allProjects = await getCollection("projects", ({ data }) => {
  return import.meta.env.PROD ? true : true; // Keep all projects
});

const sortedProjects = allProjects.sort((a, b) => b.data.pubDatetime.valueOf() - a.data.pubDatetime.valueOf());
---

<Layout title="Projects | Pratap Singh">
  <Header />
  <Main pageTitle="Projects" pageDesc="A selection of projects I've worked on.">
    <div class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3">
      {sortedProjects.map(project => <ProjectCard project={project} />)}
    </div>
  </Main>
  <Footer />
</Layout>